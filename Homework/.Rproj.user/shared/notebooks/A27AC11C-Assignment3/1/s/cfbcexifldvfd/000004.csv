"0","# Start with normal distribution as proposal distribution"
"0","set.seed(1234)"
"0",""
"0","N <- 10^5"
"0","sigma <- 1.5"
"0","f <- function(x) (2+sin(1/x))/exp(x^2)"
"0","g <- function(x) rnorm(1, x, sigma)"
"0",""
"0","x <- numeric(N)"
"0","x[1] <- g(0)"
"0","k <- 0"
"0","u <- runif(N)"
"0",""
"0","for (i in 2:N) { "
"0","  xt <- x[i-1]"
"0","  y <- g(xt)"
"0","  num <- f(y) * dnorm(xt, y, sigma) "
"0","  den <- f(xt) * dnorm(y, xt, sigma) "
"0","  if (u[i] <= num/den) x[i] <- y else {"
"0","  x[i] <- xt "
"0","  k <- k+1"
"0","  }"
"0","}"
"0",""
"0","x <- x[-c(1:1000)]"
"0",""
"0","1 - k/(N-10^3) # acceptance rate "
"1","[1]"
"1"," 0.4284646"
"1","
"
