"0","#### Empirical bootstrap algorithm"
"0","B <- 1000"
"0","set.seed(1000)"
"0",""
"0","M1 <- model.matrix(fit)"
"0",""
"0","beta_stars <- t(sapply(1:B, function(b){"
"0","  y <- fit$fitted  + sample(residuals(fit), replace = TRUE) # empirical "
"0","  bstar <- coefficients(lm(y ~ M1 - 1, data = dat)) "
"0","  return(t(bstar))"
"0","  }))"
"0",""
"0","### construct the confident intervals"
"0","se_boot <- apply(beta_stars, 2, sd) # Bootstrap se's of the coefficients"
"0","results <- rep(fit$coefficients, 2) + # estimate"
"0","  rep(se_boot,2) * qnorm(c(0.025, 0.025, 0.975, 0.975)) "
"0","names(results) <- c('int_low', 'beta_low', 'int_high', 'beta_high')"
